# Building BURAI

This document explains how to build BURAI from source.

## Prerequisites

- JDK 1.8 or later (the build produces Java 1.8 compatible bytecode)
- Apache Ant 1.7 or later
- JavaFX libraries (OpenJFX)

**Note:** While newer JDK versions can be used to compile, the build targets Java 1.8 compatibility (`-source 1.8 -target 1.8`).

### Installing JavaFX on Ubuntu/Debian

```bash
sudo apt install openjfx
```

The build scripts are configured to look for JavaFX at `/usr/share/openjfx/lib/`. If you have JavaFX installed in a different location, you can specify it using the `path.to.fx` property:

```bash
ant -Dpath.to.fx=/path/to/javafx/lib -f bin/build_compile.xml build
```

If JavaFX is not found, the build will fail with a clear error message.

## Build Scripts

BURAI provides two Ant build scripts:

### 1. `bin/build_compile.xml` - Main Build Script (Recommended)

This is the primary build script that handles both compilation and JAR creation.

**Available targets:**

- `compile` - Compile Java source files to `class/` directory
- `jar` - Create executable JAR file (requires compilation first)
- `build` - Compile and create JAR in one step (recommended)
- `clean` - Remove the `class/` directory

**Usage:**

```bash
# Compile and create JAR (recommended)
ant -f bin/build_compile.xml build

# Or step by step:
ant -f bin/build_compile.xml compile
ant -f bin/build_compile.xml jar

# Clean build artifacts
ant -f bin/build_compile.xml clean
```

### 2. `bin/build.xml` - JAR Creation Only

This script creates the executable JAR from pre-compiled class files. It assumes the `class/` directory already exists with compiled classes.

**Usage:**

```bash
ant -f bin/build.xml
```

**Note:** This script was originally generated by Eclipse Runnable JAR Export Wizard and has been updated to use relative paths instead of hardcoded Windows paths.

## Build Improvements

The build scripts have been enhanced with the following improvements:

1. **Module conflicts resolved**: JavaFX `module-info.class` files are excluded from the bundled JAR to prevent conflicts with Java 11+ module system
2. **Better error handling**: Clear error messages when JavaFX is not found, with instructions on how to install or specify the location
3. **Flexible JavaFX location**: Use `-Dpath.to.fx` property to specify custom JavaFX installation paths
4. **Deprecation warnings fixed**: Updated deprecated API usage (e.g., `Double` constructor) to use modern alternatives

## Build Output

Both scripts create an executable JAR file:

- **Location:** `bin/burai.jar`
- **Main class:** `burai.app.QEFXMain`
- **Dependencies:** All required libraries (including JavaFX) are bundled into the JAR

## Running BURAI

BURAI is a JavaFX application. For Java 11 and later, JavaFX requires explicit module configuration at runtime.

### Using the Launcher Scripts (Recommended)

The easiest way to run BURAI is to use the provided launcher scripts:

**Linux/Mac:**
```bash
bin/burai
```

**Windows:**
```cmd
bin\burai.bat
```

These scripts automatically configure the JavaFX module path and launch BURAI.

### Manual Launch

If you prefer to run the JAR directly, use:

```bash
java --module-path /usr/share/openjfx/lib \
     --add-modules javafx.controls,javafx.fxml,javafx.web,javafx.media,javafx.swing \
     -jar bin/burai.jar
```

**Note:** On Windows, adjust the module path to your JavaFX installation location (e.g., `C:\javafx-sdk\lib`).

## Quick Start

For first-time builds, use:

```bash
ant -f bin/build_compile.xml build
bin/burai
```

## Troubleshooting

### "Could not find or load main class" or "NoClassDefFoundError: javafx/application/Application"

This error occurs when trying to run BURAI with `java -jar bin/burai.jar` on Java 11+.

**Solution:** Use the launcher scripts (`bin/burai` or `bin/burai.bat`) or run with JavaFX module arguments:

```bash
java --module-path /usr/share/openjfx/lib \
     --add-modules javafx.controls,javafx.fxml,javafx.web,javafx.media,javafx.swing \
     -jar bin/burai.jar
```

### "JavaFX runtime components are missing"

This error means JavaFX is not installed on your system.

**Solution:** Install OpenJFX:
```bash
sudo apt install openjfx  # Ubuntu/Debian
```

For Windows, download JavaFX SDK from https://openjfx.io/ and set `JAVAFX_LIB_PATH` environment variable.

### "package javafx.scene.control does not exist"

This error means JavaFX libraries are not found during compilation.

**Solution:** 
1. Install OpenJFX: `sudo apt install openjfx`
2. If JavaFX is installed in a non-standard location, specify it:
   ```bash
   ant -Dpath.to.fx=/path/to/javafx/lib -f bin/build_compile.xml build
   ```

### "ERROR: JavaFX libraries not found"

This error occurs during the JAR creation step when JavaFX cannot be found at the expected location.

**Solution:** Same as above - install OpenJFX or specify the correct path using the `-Dpath.to.fx` option.

### "cannot find symbol" errors

These are usually caused by:

1. Missing JavaFX libraries (see above)
2. Incorrect Java version (need JDK 1.8+)

Check your Java version:

```bash
java -version
javac -version
```

## Character Encoding

The build uses UTF-8 encoding for source files. Do not change the `source.encoding` property in `build_compile.xml` as it will cause compilation errors for Greek letters (Γ, Σ, etc.) used in the code.
